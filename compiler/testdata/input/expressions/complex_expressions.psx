def format_currency(amount):
    return f"${amount:,.2f}"

def get_status(count):
    if count == 0:
        return "empty"
    elif count < 5:
        return "low"
    else:
        return "good"

view ComplexExpressions(items: list, user: dict):
    total_value = sum(item.get('price', 0) for item in items)
    
    <div>
        <h1>{user.get('name', 'Anonymous').title()}</h1>
        <p>Items: {len(items)} ({get_status(len(items))})</p>
        <p>Total: {format_currency(total_value)}</p>
        <p>Average: {format_currency(total_value / len(items)) if items else "N/A"}</p>
        
        <div class={f"status-{get_status(len(items))}"}>
            f"Status: {get_status(len(items)).upper()}"
        </div>
        
        <ul>
            for item in items[:3]:  # Show only first 3
                <li>
                    {item.get('name', 'Unknown')} - {format_currency(item.get('price', 0))}
                </li>
        </ul>
        
        if len(items) > 3:
            <p>... and {len(items) - 3} more items</p>
    </div>